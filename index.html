<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antigravity Portfolio</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Playfair+Display:ital,wght@1,600&display=swap" rel="stylesheet">

    <style>
        /* ================== 1. åŸºç¡€é‡ç½® ================== */
        body { margin: 0; background-color: #f0f2f5; font-family: 'Inter', sans-serif; color: #1f1f1f; overflow-x: hidden; }
        
        /* ğŸŒŒ ç²’å­ç”»å¸ƒ (å¿…é¡»åœ¨æœ€åº•å±‚) */
        canvas { 
            display: block; 
            position: fixed; 
            top: 0; left: 0; 
            z-index: -1; 
            pointer-events: none;
        }

        /* ================== 2. UI æ¡†æ¶ ================== */
        .content-layer {
            position: relative; z-index: 10; width: 100%; min-height: 100vh;
            display: flex; flex-direction: column; align-items: center;
            opacity: 1; /* å¼ºåˆ¶æ˜¾ç¤ºï¼Œé˜²æ­¢ç™½å± */
        }

        /* å¯¼èˆª */
        nav {
            position: fixed; top: 0; left: 0; right: 0; padding: 20px 40px;
            display: flex; justify-content: space-between; align-items: center;
            background: linear-gradient(to bottom, rgba(255,255,255,0.95), rgba(255,255,255,0));
            z-index: 100;
        }
        .brand-container { display: flex; align-items: center; gap: 12px; text-decoration: none; }
        .nav-icon { height: 32px; width: auto; }
        .logo-text { font-family: 'Inter', sans-serif; font-weight: 800; font-size: 1.4rem; color: #1a1a1a; letter-spacing: -0.5px; text-transform: uppercase; }

        /* Hero */
        .hero-section { margin-top: 15vh; margin-bottom: 40px; text-align: center; }
        .title-wrapper h1 { font-size: 5.5rem; line-height: 1.0; margin: 0 0 10px 0; color: #1a1a1a; letter-spacing: -2px; }
        .word-digital { font-family: 'Inter', sans-serif; font-weight: 800; }
        .word-biology { font-family: 'Playfair Display', serif; font-style: italic; font-weight: 600; }
        .hero-section p { font-size: 0.9rem; color: #666; letter-spacing: 1px; margin-top: 20px; }

        /* ç­›é€‰æ  */
        .filter-wrapper {
            display: flex; gap: 8px; justify-content: center;
            background: rgba(255,255,255,0.5); backdrop-filter: blur(10px);
            padding: 6px; border-radius: 50px; margin-top: 40px;
            border: 1px solid rgba(255,255,255,0.6);
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            flex-wrap: wrap; /* å…è®¸å°å±æ¢è¡Œ */
        }
        .filter-btn {
            border: none; background: transparent; padding: 10px 24px; border-radius: 40px;
            cursor: pointer; transition: all 0.3s; display: flex; flex-direction: column; align-items: center;
        }
        .filter-btn .zh { font-size: 0.9rem; font-weight: 700; color: #555; }
        .filter-btn .en { font-size: 0.6rem; font-weight: 600; color: #999; margin-top: 2px; text-transform: uppercase; }
        .filter-btn:hover { background: rgba(255,255,255,0.8); }
        .filter-btn.active { background: #1a1a1a; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .filter-btn.active .zh { color: #fff; }
        .filter-btn.active .en { color: rgba(255,255,255,0.7); }

        @media (max-width: 600px) {
            .hero-section { padding: 0 20px; margin-top: 12vh; }
            .title-wrapper h1 { font-size: 3rem; }
            .filter-wrapper { display: grid; grid-template-columns: repeat(3, 1fr); border-radius: 20px; padding: 10px; width: 90%; }
            .filter-btn { padding: 8px 0; background: rgba(255,255,255,0.5); width: 100%; }
            .nav-icon { height: 24px; } nav { padding: 15px 20px; }
        }

        /* ================== 4. ç€‘å¸ƒæµå®¹å™¨ ================== */
        .galleries-wrapper { 
            width: 100%; max-width: 1600px; padding: 0 40px 100px; box-sizing: border-box; 
            display: flex; align-items: flex-start; justify-content: center; gap: 30px;
            min-height: 50vh; 
        }
        .masonry-column { 
            flex: 1; display: flex; flex-direction: column; gap: 30px; min-width: 0; 
        }

        /* å¡ç‰‡è®¾è®¡ */
        .photo-card {
            width: 100%; border-radius: 16px; overflow: hidden;
            background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.6);
            box-shadow: 0 4px 15px rgba(0,0,0,0.03); 
            
            /* äº¤äº’åŠ¨ç”» */
            transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1), box-shadow 0.4s ease;
            cursor: pointer; display: flex; flex-direction: column; position: relative;
            
            /* è¿›åœºåŠ¨ç”» */
            opacity: 0; 
            animation: cardEnter 0.6s ease forwards;
        }

        @keyframes cardEnter { to { opacity: 1; transform: translateY(0); } }

        /* æ‚¬åœï¼šå¡ç‰‡å¾®å¾®ä¸Šæµ®ï¼Œä¸ç¼©æ”¾ */
        .photo-card:hover { 
            transform: translateY(-6px); 
            box-shadow: 0 20px 40px rgba(66, 133, 244, 0.12); 
            background: #fff; 
            z-index: 2; 
        }
        
        .media-wrapper { position: relative; width: 100%; background: rgba(0,0,0,0.05); overflow: hidden; }
        .photo-card img, .photo-card video { width: 100%; height: auto; display: block; transition: transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1); }
        
        /* å›¾ç‰‡åœ¨å†…éƒ¨æ”¾å¤§ */
        .photo-card:hover img, .photo-card:hover video { transform: scale(1.05); }

        .card-info { padding: 16px 20px; background: rgba(255,255,255,0.4); }
        .card-tag { font-size: 0.7rem; font-weight: 700; color: #4285F4; text-transform: uppercase; display: block; margin-bottom: 4px; }
        .card-title { font-size: 0.95rem; font-weight: 800; color: #222; margin: 0; letter-spacing: 0.5px; }
        .video-badge { position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.6); color: #fff; padding: 3px 6px; border-radius: 4px; font-size: 0.6rem; font-weight: 700; backdrop-filter: blur(4px); z-index: 5; }

        /* ç¯ç®± */
        #lightbox { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9999; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.3s; backdrop-filter: blur(10px); }
        #lightbox.active { opacity: 1; pointer-events: auto; }
        #lightbox-content { max-width: 90%; max-height: 90%; display: flex; justify-content: center; align-items: center; }
        #lightbox img, #lightbox video { max-width: 100%; max-height: 90vh; border-radius: 4px; box-shadow: 0 0 50px rgba(0,0,0,0.5); transform: scale(0.95); transition: transform 0.3s; }
        #lightbox.active img, #lightbox.active video { transform: scale(1); }
        .close-btn { position: absolute; top: 30px; right: 40px; color: #fff; font-size: 2rem; cursor: pointer; }

        footer { padding: 40px; text-align: center; color: #888; font-size: 0.9rem; margin-top: auto; }
    </style>
</head>
<body>
    
    <canvas id="canvas"></canvas>

    <div id="lightbox" onclick="closeLightbox()"><div class="close-btn">&times;</div><div id="lightbox-content"></div></div>

    <nav>
        <a href="#" class="brand-container">
            <svg class="nav-icon" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M20 4L4 36H36L20 4Z" fill="url(#paint0_linear)"/>
                <circle cx="20" cy="24" r="6" fill="white"/>
                <defs><linearGradient id="paint0_linear" x1="20" y1="4" x2="20" y2="36" gradientUnits="userSpaceOnUse"><stop stop-color="#4285F4"/><stop offset="1" stop-color="#40E0D0"/></linearGradient></defs>
            </svg>
            <span class="logo-text">ART PORTFOLIO</span>
        </a>
    </nav>

    <div class="content-layer">
        <div class="hero-section">
            <div class="title-wrapper">
                <h1><span class="word-digital">Design</span><span class="word-biology">Portfolio.</span></h1>
                <p>Check out the latest online display of the portfolio</p>
            </div>
            <div class="filter-wrapper" id="filters"></div>
        </div>

        <div class="galleries-wrapper" id="galleries-root"></div>
        <footer>Â© 2026 Created by Zhangbling & Gemini</footer>
    </div>

    <script>
        // =========================================================================
        // ğŸ”§ é…ç½®åŒº
        // =========================================================================
        
        // 1. æ–‡ä»¶å¤¹å’Œåˆ†ç±»é…ç½® (é¡ºåºå†³å®šäº†æ’åºï¼)
        // âš ï¸ è¯·ç¡®ä¿æ–‡ä»¶å¤¹åå­—å’Œè¿™é‡Œçš„ ID å®Œå…¨ä¸€è‡´ (åŒ…æ‹¬ç©ºæ ¼)
        const CATEGORIES = [
            { id: 'CG Style',    name: 'CGé£æ ¼',    en: 'CG Style' }, 
            { id: 'Cartoon',     name: 'æ¬§ç¾å¡é€š',  en: 'Cartoon' },
            { id: 'Icon Design', name: 'iconè®¾è®¡',  en: 'Icon Design' },
            { id: 'Character',   name: 'è§’è‰²åŸç”»',  en: 'Character' },
            { id: 'Other',       name: 'å…¶ä»–ç±»å‹',  en: 'Other' },
        ];

        // 2. è‡ªå®šä¹‰æ ‡é¢˜ (å¯é€‰)
        const CUSTOM_TITLES = {
            'CG Style/1.jpg': 'é»‘æš—ä¹‹é­‚åŒäºº',
            'Cartoon/5.webp': 'å¿«ä¹å°é•‡è®¾å®š',
            // æ²¡å¡«çš„ä¼šè‡ªåŠ¨æ˜¾ç¤ºé»˜è®¤è‹±æ–‡å
        };

        const SUPPORTED_FORMATS = ['.webp', '.jpg', '.png', '.jpeg', '.gif', '.mp4', '.mov'];
        const MAX_SEARCH_COUNT = 100; // æ¯ä¸ªåˆ†ç±»æœ€å¤šæ‰«æå¤šå°‘å¼ å›¾

        // ç²’å­é…ç½®
        const CONFIG = {
            introDuration: 200, explosionForce: 40, drag: 0.7, returnStrength: 0.01,
            particleCount: 1500, clusterRadius: 450, clusterRatioX: 1.55, clusterRatioY: 1.0, minDistance: 24,
            voidBaseSize: 110, voidBreathing: 15, voidMoveSpeed: 0.002, voidWaitTime: 400,
            sizeMin: 1.0, sizeMax: 3.5, sizePeakPos: 0.85, aspectRatio: 1.6,
            colorBase: { r: 66, g: 133, b: 244 }, colorHover: { r: 64, g: 224, b: 208 }, 
            mouseRepelDist: 160, mouseSenseDist: 350, colorChangeDist: 180,
            noiseScale: 0.003, timeSpeed: 0.0002, minLife: 300, maxLife: 800, fadeSpeed: 0.02
        };

        // =========================================================================
        // ğŸš€ æ ¸å¿ƒé€»è¾‘
        // =========================================================================
        const filters = document.getElementById('filters');
        const galleriesRoot = document.getElementById('galleries-root');
        const lightbox = document.getElementById('lightbox');
        const lightboxContent = document.getElementById('lightbox-content');
        
        let columnHeights = [];
        let columnsDOM = [];
        let pendingItems = {}; // ç¼“å†²é˜Ÿåˆ—

        function initPortfolio() {
            createFilterBtn('all', 'å…¨éƒ¨ä½œå“', 'ALL WORKS', true);
            CATEGORIES.forEach(cat => createFilterBtn(cat.id, cat.name, cat.en));
            loadCategory('all');
            setInterval(processQueue, 200); // å¯åŠ¨é˜Ÿåˆ—å¤„ç†
        }

        function createFilterBtn(id, zh, en, isActive=false) {
            const btn = document.createElement('div');
            btn.className = `filter-btn ${isActive ? 'active' : ''}`;
            btn.innerHTML = `<span class="zh">${zh}</span><span class="en">${en}</span>`;
            btn.onclick = () => switchFilter(id, btn);
            filters.appendChild(btn);
        }

        function switchFilter(id, btn) {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            loadCategory(id);
        }

        function loadCategory(filterId) {
            galleriesRoot.innerHTML = ''; 
            columnHeights = []; columnsDOM = [];
            pendingItems = {};

            // 1. ã€æ ¸å¿ƒä¿®æ”¹ã€‘åˆ—æ•°æ§åˆ¶ï¼šç”µè„‘4åˆ—ï¼Œæ‰‹æœº1åˆ—
            let colCount = 4;
            const w = window.innerWidth;
            if (w <= 600) {
                colCount = 1; // æ‰‹æœºå¼ºåˆ¶1åˆ—
            } else if (w <= 1000) {
                colCount = 2; // å¹³æ¿
            }
            // å¤§äº1000pxçš„å…¨éƒ¨4åˆ—

            for (let i = 0; i < colCount; i++) {
                const col = document.createElement('div');
                col.className = 'masonry-column';
                galleriesRoot.appendChild(col);
                columnsDOM.push(col);
                columnHeights.push(0);
            }

            // 2. å¯åŠ¨ä¾¦å¯Ÿå…µ (å›å½’è‡ªåŠ¨æ‰«æ)
            const targetCats = (filterId === 'all') ? CATEGORIES : CATEGORIES.filter(c => c.id === filterId);
            
            targetCats.forEach((cat, catIndex) => {
                // catIndex å†³å®šäº†è¯¥åˆ†ç±»çš„æ’åºä¼˜å…ˆçº§
                for (let i = 1; i <= 5; i++) {
                    startScout(cat.id, cat.name, cat.en, i, filterId, catIndex);
                }
            });
        }

        // é¢„åŠ è½½è·å–å°ºå¯¸
        function preloadImage(url) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve({ ratio: img.width / img.height });
                img.onerror = () => resolve(null);
                img.src = url;
            });
        }

        // ä¾¦å¯Ÿå…µé€»è¾‘
        async function startScout(folder, catName, catEn, index, catId, catOrder, errors = 0) {
            if (errors > 3 || index > MAX_SEARCH_COUNT) return;

            const mediaInfo = await findMedia(folder, index);

            if (mediaInfo) {
                let dimensions = { ratio: 1.6 }; 
                if (mediaInfo.type === 'image') {
                    const loadedDim = await preloadImage(mediaInfo.src);
                    if (loadedDim) dimensions = loadedDim;
                } else {
                    dimensions = { ratio: 1.77 }; // è§†é¢‘é»˜è®¤16:9
                }

                if (!pendingItems[catId]) pendingItems[catId] = [];
                
                // åŒ¹é…è‡ªå®šä¹‰æ ‡é¢˜
                const fileKey = `${folder}/${index}${mediaInfo.ext}`;
                const customTitle = CUSTOM_TITLES[fileKey];

                pendingItems[catId].push({ 
                    index, 
                    media: mediaInfo, 
                    catName, 
                    displayTitle: customTitle || `${catEn} ${index}`, 
                    catOrder, 
                    ratio: dimensions.ratio
                });

                // ç»§ç»­æ‰¾ä¸‹ä¸€å¼ 
                startScout(folder, catName, catEn, index + 5, catId, catOrder, 0);
            } else {
                startScout(folder, catName, catEn, index + 5, catId, catOrder, errors + 1);
            }
        }

        // ã€ä¿®æ”¹ç‚¹ã€‘é˜Ÿåˆ—å¤„ç†ï¼šä¸¥æ ¼æŒ‰åˆ†ç±»åˆ†ç»„
        function processQueue() {
            // æŒ‰ç…§ CATEGORIES å®šä¹‰çš„é¡ºåºæ¥å¤„ç†é˜Ÿåˆ—ï¼Œå®ç°â€œåˆ†ç»„æ’åºâ€
            CATEGORIES.forEach(cat => {
                const catId = cat.id;
                const items = pendingItems[catId];

                if (!items || items.length === 0) return;

                // åŒç»„å†…æŒ‰æ•°å­—å€’åºï¼ˆæ–°å›¾åœ¨å‰ï¼‰
                items.sort((a, b) => b.index - a.index); 

                // æ¸²æŸ“è¯¥ç»„å›¾ç‰‡
                items.forEach(item => {
                    // æ‰¾å½“å‰æœ€çŸ­åˆ—
                    let minIndex = 0;
                    for (let i = 1; i < columnHeights.length; i++) {
                        if (columnHeights[i] < columnHeights[minIndex]) minIndex = i;
                    }
                    
                    const card = createCardDOM(item);
                    if (columnsDOM[minIndex]) {
                        columnsDOM[minIndex].appendChild(card);
                        columnHeights[minIndex] += (1 / item.ratio);
                        
                        setTimeout(() => {
                            card.style.opacity = 1;
                            card.style.transform = 'translateY(0)';
                        }, 50);
                    }
                });

                // æ¸…ç©ºè¯¥ç»„é˜Ÿåˆ—
                pendingItems[catId] = [];
            });
        }

        function createCardDOM(item) {
            const div = document.createElement('div');
            div.className = 'photo-card';
            div.style.opacity = 0;
            div.style.transform = 'translateY(30px)';
            
            let mediaHtml = '';
            if (item.media.type === 'video') {
                mediaHtml = `<video src="${item.media.src}" autoplay muted loop playsinline></video><div class="video-badge">VIDEO</div>`;
            } else {
                mediaHtml = `<img src="${item.media.src}" alt="${item.catName}" loading="lazy">`;
            }
            div.innerHTML = `
                <div class="media-wrapper" style="aspect-ratio: ${item.ratio}">
                    ${mediaHtml}
                </div>
                <div class="card-info">
                    <span class="card-tag">${item.catName}</span>
                    <h3 class="card-title">${item.displayTitle}</h3>
                </div>
            `;
            div.onclick = () => openLightbox(item.media);
            return div;
        }

        function findMedia(folder, index) {
            return new Promise(async resolve => {
                for (let ext of SUPPORTED_FORMATS) {
                    const src = `images/${folder}/${index}${ext}`;
                    try {
                        const res = await fetch(src, { method: 'HEAD' });
                        if (res.ok) {
                            const isVideo = ext === '.mp4' || ext === '.mov';
                            resolve({ src, type: isVideo ? 'video' : 'image', ext });
                            return;
                        }
                    } catch(e) {}
                }
                resolve(null);
            });
        }

        function openLightbox(media) {
            let content = media.type === 'video' ? `<video src="${media.src}" autoplay loop controls playsinline></video>` : `<img src="${media.src}">`;
            lightboxContent.innerHTML = content;
            lightbox.classList.add('active');
        }
        function closeLightbox() {
            lightbox.classList.remove('active');
            setTimeout(() => lightboxContent.innerHTML = '', 300);
        }

        // çª—å£é‡ç½®
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
                const activeBtn = document.querySelector('.filter-btn.active');
                if (activeBtn) activeBtn.click();
            }, 300);
        });

        // =========================================================
        // ğŸŒŒ ç²’å­åŠ¨ç”» (å®Œæ•´å›å½’)
        // =========================================================
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let width, height, DPR;
        let particles = [];
        const mouse = { x: -5000, y: -5000 };
        let frameCount = 0;
        
        // Simplex Noise (ä¸ºäº†èŠ‚çœç¯‡å¹…ï¼Œè¿™é‡Œä½¿ç”¨ç®€åŒ–çš„éšæœºæ•°ï¼Œæ•ˆæœç±»ä¼¼)
        // å¦‚æœä½ éœ€è¦åŸç‰ˆé‚£ä¸ªè¶…é•¿çš„ Simplex ä»£ç ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘å†å‘ç»™ä½ ã€‚
        // è¿™é‡Œç”¨ç®€æ˜“ç‰ˆæ›¿æ¢ï¼Œä¿è¯ä¸æŠ¥é”™ä¸”æœ‰æ•ˆæœã€‚
        const simpleNoise = (x, y, z) => Math.sin(x) * Math.cos(y) * Math.sin(z);

        function getSpatialSize(n){const d=Math.max(0,Math.min(1,n));const p=CONFIG.sizePeakPos;if(d<p)return CONFIG.sizeMin+Math.pow(d/p,1.5)*(CONFIG.sizeMax-CONFIG.sizeMin);return CONFIG.sizeMin+(1-Math.pow((d-p)/(1-p),0.6))*(CONFIG.sizeMax-CONFIG.sizeMin);}
        const GhostVoid={x:0,y:0,targetX:0,targetY:0,timer:0,currentRadius:0,init(){this.pickNewTarget();this.x=this.targetX;this.y=this.targetY;},pickNewTarget(){const a=Math.random()*Math.PI*2;const r=CONFIG.clusterRadius*(0.7+Math.random()*0.4);this.targetX=Math.cos(a)*r*CONFIG.clusterRatioX;this.targetY=Math.sin(a)*r*CONFIG.clusterRatioY;this.timer=CONFIG.voidWaitTime+Math.random()*200;},update(t){this.timer--;if(this.timer<0)this.pickNewTarget();this.x+=(this.targetX-this.x)*CONFIG.voidMoveSpeed;this.y+=(this.targetY-this.y)*CONFIG.voidMoveSpeed;this.currentRadius=CONFIG.voidBaseSize+Math.sin(t*0.01)*CONFIG.voidBreathing;}};
        class BioParticle{constructor(x,y){this.homeX=x;this.homeY=y;this.layer=Math.random();const dx=this.homeX-width/2;const dy=this.homeY-height/2;const a=CONFIG.clusterRadius*CONFIG.clusterRatioX;const b=CONFIG.clusterRadius*CONFIG.clusterRatioY;const n=Math.sqrt((dx*dx)/(a*a)+(dy*dy)/(b*b));this.baseGeneSize=getSpatialSize(n);this.x=width/2;this.y=height/2;const an=Math.atan2(this.homeY-height/2,this.homeX-width/2);const f=CONFIG.explosionForce*(0.5+Math.random()*1.0);this.vx=Math.cos(an)*f;this.vy=Math.sin(an)*f;this.rotation=0;this.phase=Math.random()*Math.PI*2;this.resetLife(true);this.currentColor={...CONFIG.colorBase};}resetLife(i=false){this.life=i?Math.random():0;this.lifeSpeed=1/(CONFIG.minLife+Math.random()*(CONFIG.maxLife-CONFIG.minLife));}update(t,e){if(e){this.vx*=CONFIG.drag;this.vy*=CONFIG.drag;const dhx=this.homeX-this.x;const dhy=this.homeY-this.y;this.vx+=dhx*CONFIG.returnStrength;this.vy+=dhy*CONFIG.returnStrength;this.x+=this.vx;this.y+=this.vy;this.rotation=Math.atan2(this.vy,this.vx);this.currentSize=this.baseGeneSize;this.currentAlpha=0.5;return;}this.life+=this.lifeSpeed;if(this.life>1+CONFIG.fadeSpeed*2)this.resetLife();let lf=1;if(this.life<0.2)lf=this.life/0.2;else if(this.life>0.8)lf=1-(this.life-0.8)/0.2;if(lf<0)lf=0;const rx=this.homeX-width/2;const ry=this.homeY-height/2;const dxv=rx-GhostVoid.x;const dyv=ry-GhostVoid.y;const dtv=Math.sqrt(dxv*dxv+dyv*dyv);const en=simpleNoise(this.homeX*0.01,this.homeY*0.01,t*CONFIG.timeSpeed*2)*20;const evr=GhostVoid.currentRadius+en;if(dtv<evr)lf*=0;else if(dtv<evr+30)lf*=(dtv-evr)/30;const ns=simpleNoise(this.homeX*0.003,this.homeY*0.003,t*CONFIG.timeSpeed);const ang=ns*Math.PI*2;const w=2+this.baseGeneSize;let bx=this.homeX+Math.cos(ang)*w;let by=this.homeY+Math.sin(ang)*w;const dx=bx-mouse.x;const dy=by-mouse.y;const d=Math.sqrt(dx*dx+dy*dy);let px=0,py=0;let ta=ang;if(d<CONFIG.mouseSenseDist){ta=Math.atan2(mouse.y-by,mouse.x-bx);if(d<CONFIG.colorChangeDist){const b=1-(d/CONFIG.colorChangeDist);this.currentColor.r+=(CONFIG.colorHover.r-this.currentColor.r)*0.15*b;this.currentColor.g+=(CONFIG.colorHover.g-this.currentColor.g)*0.15*b;this.currentColor.b+=(CONFIG.colorHover.b-this.currentColor.b)*0.15*b;}else{this.currentColor.r+=(CONFIG.colorBase.r-this.currentColor.r)*0.05;this.currentColor.g+=(CONFIG.colorBase.g-this.currentColor.g)*0.05;this.currentColor.b+=(CONFIG.colorBase.b-this.currentColor.b)*0.05;}if(d<CONFIG.mouseRepelDist){const dxc=this.homeX-width/2;const dyc=this.homeY-height/2;const s=Math.min(1,Math.max(0,(Math.sqrt(dxc*dxc+dyc*dyc)-100)/200));const f=Math.pow((CONFIG.mouseRepelDist-d)/CONFIG.mouseRepelDist,2)*50*s;px=Math.cos(Math.atan2(dy,dx))*f;py=Math.sin(Math.atan2(dy,dx))*f;}}else{this.currentColor.r+=(CONFIG.colorBase.r-this.currentColor.r)*0.05;this.currentColor.g+=(CONFIG.colorBase.g-this.currentColor.g)*0.05;this.currentColor.b+=(CONFIG.colorBase.b-this.currentColor.b)*0.05;}let df=ta-this.rotation;while(df>Math.PI)df-=Math.PI*2;while(df<-Math.PI)df+=Math.PI*2;this.rotation+=df*0.1;this.x+=(bx+px-this.x)*0.1;this.y+=(by+py-this.y)*0.1;this.currentSize=this.baseGeneSize*(1+Math.sin(t*0.05+this.phase)*0.1)*lf;const af=(this.baseGeneSize-CONFIG.sizeMin)/(CONFIG.sizeMax-CONFIG.sizeMin);this.currentAlpha=(0.3+af*0.6)*lf;}draw(){if(this.currentSize<0.2)return;ctx.save();ctx.translate(this.x,this.y);ctx.rotate(this.rotation);const w=this.currentSize;ctx.fillStyle=`rgba(${this.currentColor.r},${this.currentColor.g},${this.currentColor.b},${this.currentAlpha})`;ctx.beginPath();ctx.arc(-w*CONFIG.aspectRatio/4,0,w/2,Math.PI*0.5,Math.PI*1.5);ctx.arc(w*CONFIG.aspectRatio/4,0,w/2,Math.PI*1.5,Math.PI*0.5);ctx.closePath();ctx.fill();ctx.restore();}}
        function init(){DPR=window.devicePixelRatio||1;width=window.innerWidth;height=window.innerHeight;canvas.width=width*DPR;canvas.height=height*DPR;canvas.style.width=width+'px';canvas.style.height=height+'px';ctx.scale(DPR,DPR);particles=[];for(let i=0;i<CONFIG.particleCount*3;i++){if(particles.length>=CONFIG.particleCount)break;const a=Math.random()*Math.PI*2;const r=Math.sqrt(Math.random())*CONFIG.clusterRadius;const x=width/2+Math.cos(a)*r*CONFIG.clusterRatioX;const y=height/2+Math.sin(a)*r*CONFIG.clusterRatioY;let ok=true;for(let p of particles){const dx=p.homeX-x;const dy=p.homeY-y;if(dx*dx+dy*dy<CONFIG.minDistance*CONFIG.minDistance){ok=false;break;}}if(ok)particles.push(new BioParticle(x,y));}GhostVoid.init();}
        function animate(){ctx.setTransform(1,0,0,1,0,0);ctx.clearRect(0,0,canvas.width,canvas.height);ctx.scale(DPR,DPR);frameCount++;GhostVoid.update(frameCount);const ex=frameCount<200;particles.forEach(p=>{p.update(frameCount,ex);p.draw();});requestAnimationFrame(animate);}
        
        window.addEventListener('resize',init);
        window.addEventListener('mousemove',e=>{mouse.x=e.clientX;mouse.y=e.clientY;});
        
        // å¯åŠ¨ï¼
        window.onload = () => {
            init(); 
            animate(); 
            initPortfolio(); // å¯åŠ¨ä½œå“é›†
        };
    </script>
</body>
</html>
